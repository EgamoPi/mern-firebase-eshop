{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { createElement as $, useState, useEffect } from 'react';\nimport { toast } from 'react-toastify';\nimport axios from 'axios';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { auth } from '../../firebase';\nimport { registrationValidation } from '../../utils/validation';\n\nconst createOrUpdateUser = async authtoken => {\n  const result = await axios.post(`${process.env.REACT_APP_API_URL}/create-or-update-user`, {}, {\n    headers: {\n      authtoken\n    }\n  });\n  return result;\n};\n\nconst RegisterComplete = ({\n  history\n}) => {\n  _s();\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const dispatch = useDispatch();\n  const userState = useSelector(state => ({ ...state\n  }));\n  useEffect(() => {\n    setEmail(window.localStorage.getItem('emailForRegistration'));\n  }, []);\n\n  const handleSubmit = async e => {\n    try {\n      e.preventDefault();\n\n      if (registrationValidation(email, password) === 0) {\n        return;\n      }\n\n      const result = await auth.signInWithEmailLink(email, window.location.href);\n\n      if (result.user.emailVerified) {\n        // Remove user email from local storage\n        window.localStorage.removeItem('emailForRegistration'); // Get user id token\n\n        const user = auth.currentUser;\n        await user.updatePassword(password);\n        const idTokenResult = await user.getIdTokenResult(); // Redux store\n\n        createOrUpdateUser(idTokenResult.token).then(res => {\n          console.log(res.data);\n          dispatch({\n            type: 'LOGGED_IN_USER',\n            payload: {\n              email: res.data.email,\n              name: res.data.name,\n              token: idTokenResult.token\n            }\n          });\n        }).catch(err => console.log(err)); // Redirect\n\n        history.push('/');\n      }\n\n      toast.success(`Registration Completed`);\n    } catch (error) {\n      toast.error(error.message);\n    }\n  };\n\n  return /*#__PURE__*/$('div', {\n    className: 'container p-5'\n  }, /*#__PURE__*/$('div', {\n    className: 'row'\n  }, /*#__PURE__*/$('div', {\n    className: 'col-md-6 offset-md-3'\n  }, /*#__PURE__*/$('h4', null, 'Register'), /*#__PURE__*/$('h6', null, 'Register Form'), /*#__PURE__*/$('form', {\n    onSubmit: handleSubmit\n  }, /*#__PURE__*/$('input', {\n    type: 'email',\n    className: 'form-control',\n    value: email,\n    autoFocus: true,\n    disabled: true\n  }), /*#__PURE__*/$('input', {\n    type: 'password',\n    className: 'form-control',\n    value: password,\n    onChange: e => setPassword(e.target.value),\n    autoFocus: true,\n    placeholder: 'password'\n  }), /*#__PURE__*/$('button', {\n    type: 'submit',\n    className: 'btn btn-raiser'\n  }, 'Register')))));\n};\n\n_s(RegisterComplete, \"ib4xGmyfGT/Jketr+lW2y1fLS0U=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = RegisterComplete;\nexport default RegisterComplete;\n\nvar _c;\n\n$RefreshReg$(_c, \"RegisterComplete\");","map":{"version":3,"sources":["/Users/jonathann-gs/Documents/E-commerce/client/src/pages/auth/RegisterComplete.js"],"names":["createElement","$","useState","useEffect","toast","axios","useDispatch","useSelector","auth","registrationValidation","createOrUpdateUser","authtoken","result","post","process","env","REACT_APP_API_URL","headers","RegisterComplete","history","email","setEmail","password","setPassword","dispatch","userState","state","window","localStorage","getItem","handleSubmit","e","preventDefault","signInWithEmailLink","location","href","user","emailVerified","removeItem","currentUser","updatePassword","idTokenResult","getIdTokenResult","token","then","res","console","log","data","type","payload","name","catch","err","push","success","error","message","className","onSubmit","value","autoFocus","disabled","onChange","target","placeholder"],"mappings":"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","sourcesContent":["import { createElement as $, useState, useEffect } from 'react'\nimport { toast } from 'react-toastify'\nimport axios from 'axios'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { auth } from '../../firebase'\nimport { registrationValidation } from '../../utils/validation'\n\nconst createOrUpdateUser = async (authtoken) => {\n  const result = await axios.post(\n    `${process.env.REACT_APP_API_URL}/create-or-update-user`,\n    {},\n    {\n      headers: {\n        authtoken,\n      },\n    },\n  )\n  return result\n}\n\nconst RegisterComplete = ({ history }) => {\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n\n  const dispatch = useDispatch()\n\n  const userState = useSelector((state) => ({ ...state }))\n\n  useEffect(() => {\n    setEmail(window.localStorage.getItem('emailForRegistration'))\n  }, [])\n\n  const handleSubmit = async (e) => {\n    try {\n      e.preventDefault()\n      if (registrationValidation(email, password) === 0) {\n        return\n      }\n      const result = await auth.signInWithEmailLink(email, window.location.href)\n      if (result.user.emailVerified) {\n        // Remove user email from local storage\n        window.localStorage.removeItem('emailForRegistration')\n        // Get user id token\n        const user = auth.currentUser\n        await user.updatePassword(password)\n        const idTokenResult = await user.getIdTokenResult()\n        // Redux store\n        createOrUpdateUser(idTokenResult.token)\n          .then((res) => {\n            console.log(res.data)\n            dispatch({\n              type: 'LOGGED_IN_USER',\n              payload: {\n                email: res.data.email,\n                name: res.data.name,\n                token: idTokenResult.token,\n              },\n            })\n          })\n          .catch((err) => console.log(err))\n        // Redirect\n        history.push('/')\n      }\n      toast.success(`Registration Completed`)\n    } catch (error) {\n      toast.error(error.message)\n    }\n  }\n  return $(\n    'div',\n    { className: 'container p-5' },\n    $(\n      'div',\n      { className: 'row' },\n      $(\n        'div',\n        { className: 'col-md-6 offset-md-3' },\n        $('h4', null, 'Register'),\n        $('h6', null, 'Register Form'),\n        $(\n          'form',\n          { onSubmit: handleSubmit },\n          $('input', {\n            type: 'email',\n            className: 'form-control',\n            value: email,\n            autoFocus: true,\n            disabled: true,\n          }),\n          $('input', {\n            type: 'password',\n            className: 'form-control',\n            value: password,\n            onChange: (e) => setPassword(e.target.value),\n            autoFocus: true,\n            placeholder: 'password',\n          }),\n\n          $(\n            'button',\n            { type: 'submit', className: 'btn btn-raiser' },\n            'Register',\n          ),\n        ),\n      ),\n    ),\n  )\n}\n\nexport default RegisterComplete\n"]},"metadata":{},"sourceType":"module"}